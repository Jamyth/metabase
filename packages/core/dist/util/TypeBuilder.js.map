{"version":3,"file":"TypeBuilder.js","sourceRoot":"","sources":["../../src/util/TypeBuilder.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Type } from '../type';\n\nexport class TypeBuilder<T = object> {\n    private isPrimitive: boolean;\n    private isArray: boolean;\n    private isNullable: boolean;\n    private isEnum: boolean;\n    private isSubclass: boolean;\n    private prefix: string | null;\n    private type: string | null;\n    private body: { [P in keyof T]: Type<T[P]> } | null;\n\n    constructor() {\n        this.isArray = false;\n        this.isNullable = false;\n        this.isEnum = false;\n        this.isSubclass = false;\n        this.prefix = null;\n        this.body = null;\n        this.type = null;\n    }\n\n    setType = (type: string) => {\n        this.type = type;\n        this.isPrimitive = this.isPrimitiveTypes();\n        return this;\n    };\n\n    setIsEnum = (isEnum: boolean) => {\n        this.isEnum = isEnum;\n        return this;\n    };\n\n    setIsSubclass = (isSubclass: boolean, prefix: string | null) => {\n        this.isSubclass = isSubclass;\n        this.prefix = prefix;\n        return this;\n    };\n\n    setIsArray = (isArray: boolean) => {\n        this.isArray = isArray;\n        return this;\n    };\n\n    setIsNullable = (isNullable: boolean) => {\n        this.isNullable = isNullable;\n        return this;\n    };\n\n    setBody = (body: { [P in keyof T]: Type<T[P]> } | null) => {\n        this.body = body;\n        return this;\n    };\n\n    build = (): Type<any> => {\n        if (!this.type) {\n            throw new Error('Type is not defined...');\n        }\n\n        if (!this.isPrimitive && !this.body) {\n            throw new Error(`Type marked as \"${this.type}\", but body is not defined.`);\n        }\n\n        return {\n            type: this.type,\n            isPrimitive: this.isPrimitive,\n            isArray: this.isArray,\n            isEnum: this.isEnum,\n            isNullable: this.isNullable,\n            isSubclass: this.isSubclass,\n            prefix: this.prefix,\n            body: this.body,\n            toString: this.toString,\n            toDefinition: this.toDefinition,\n        };\n    };\n\n    toString = () => {\n        if (!this.type) {\n            throw new Error('Type is not defined...');\n        }\n\n        const prefix = this.isSubclass && this.prefix ? `${this.prefix}$` : '';\n        const arrayText = this.isArray ? '[]' : '';\n        const nullableText = this.isNullable ? ' | null' : '';\n\n        return prefix + this.type + arrayText + nullableText;\n    };\n\n    toDefinition = () => {\n        if (!this.body) {\n            throw new Error('body is not defined');\n        }\n\n        if (this.isEnum) {\n            return JSON.stringify(this.body);\n        }\n\n        const fields = Object.entries(this.body).reduce((acc, [key, property]: any) => {\n            return Object.assign(acc, { [key]: property.toString() });\n        }, {});\n        return JSON.stringify(fields);\n    };\n\n    private isPrimitiveTypes = () => {\n        const primitives = ['string', 'number', 'boolean', 'Date', 'void'];\n        return this.type ? primitives.includes(this.type) : false;\n    };\n}\n"]}